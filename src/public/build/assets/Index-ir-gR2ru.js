import{p as ae,r as s,x as oe,z as re,c as R,w as le,a as F,b as q,h as ne,d as r,o as Y,t as j,g as O,F as se,l as de,A as ie,y as D,k as V,B as z}from"./app-oKiCCnFa.js";import{A as ce}from"./AuthenticatedLayout-B0mCR-y7.js";import{F as ue,_ as me,a as pe,l as ve,i as fe,b as xe}from"./ScheduleModal-Bvv07V_D.js";import{d}from"./dayjs.min-Dun-lqIM.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BEaRJJwb.js";import"./Footer-DodseqVY.js";import"./Modal-Bx8CoXnf.js";const ge={class:"py-8 bg-gray-50 dark:bg-gray-900 min-h-screen"},ye={class:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8"},be={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},ke={class:"p-6"},we={class:"calendar-container"},Ce={class:"mt-8"},_e={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Ye={class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 transition-transform hover:-translate-y-1 duration-300"},De={class:"text-3xl font-bold text-gray-800 dark:text-gray-100"},Se={class:"flex items-center justify-between mb-2"},Me={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ee={class:"text-3xl font-bold text-gray-800 dark:text-gray-100"},Ne={__name:"Index",setup(Ae){d.locale("ja");const{props:x}=ae(),c=s(x.events||[]),I=s(x.residents||[]),S=s(x.scheduleTypes||[]),i=s(x.monthStats||{total:0,by_type:{}}),M=s(x.currentDate||d().format("YYYY-MM-DD")),u=s(null),$=s(0),m=s(!1),h=s(null),g=s(null),E=s("スケジュール作成"),N=s(!1),A=s(null);oe(()=>x.events,t=>{t&&(c.value=t,$.value++)},{deep:!0}),re(()=>{});const G=t=>{const a=d(t.view.currentStart).format("YYYY-MM-DD"),o=d(M.value).startOf("month").format("YYYY-MM-DD");d(t.view.currentStart).startOf("month").format("YYYY-MM-DD")!==o&&D.get(route("calendar.index"),{date:a},{preserveState:!0,preserveScroll:!0,only:["events","residents","monthStats","currentDate"]})},U=t=>{var o;const a=(o=t.jsEvent)==null?void 0:o.target;a&&a.closest("[data-event-id]")||(h.value=d(t.date).format("YYYY-MM-DD"),g.value=null,m.value=!0)},P=t=>{m.value=!1,A.value=t.event,N.value=!0},W=V(()=>{const t={};return!c.value||c.value.length===0||c.value.forEach((a,o)=>{var p;if(!a.start)return;const n=d(a.start).format("YYYY-MM-DD");t[n]||(t[n]={regularSchedules:[],bathSchedules:[]}),(p=a.extendedProps)!=null&&p.resident_id?t[n].bathSchedules.push(a):t[n].regularSchedules.push(a)}),t}),K=t=>{const a=d(t.date).format("YYYY-MM-DD"),o=W.value[a],n=a===d().format("YYYY-MM-DD");document.documentElement.classList.contains("dark");const p=document.createElement("div");p.className="flex flex-col h-full w-full overflow-hidden relative group transition-colors duration-200 hover:bg-gray-50 dark:hover:bg-gray-800/50";const T=document.createElement("div");T.className="flex justify-between items-start p-1.5 border-b border-gray-100 dark:border-gray-700";const y=document.createElement("span");y.className="text-sm font-medium w-7 h-7 flex items-center justify-center rounded-full transition-colors",y.innerText=t.dayNumberText.replace("日",""),n?y.classList.add("bg-blue-600","text-white","shadow-md","dark:bg-blue-500"):y.classList.add("text-gray-700","dark:text-gray-300"),T.appendChild(y),p.appendChild(T);const k=document.createElement("div");k.className="flex-1 flex flex-col min-h-0 overflow-hidden w-full";const w=document.createElement("div");w.className="flex flex-col gap-1 p-1 overflow-y-auto h-[40%] min-h-[40px] border-2 border-red-400 cursor-pointer hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",w.addEventListener("click",e=>{e.stopPropagation(),h.value=a,g.value=null,E.value="スケジュール作成",m.value=!0}),o&&o.regularSchedules.length>0&&o.regularSchedules.forEach(e=>{var b;const l=document.createElement("div");l.className="flex items-center gap-1.5 px-2 py-1 rounded-md text-xs text-white cursor-pointer hover:opacity-90 transition-all shadow-sm transform hover:scale-[1.02]",l.style.backgroundColor=e.backgroundColor||"#3B82F6",l.style.borderLeft=`3px solid ${e.borderColor||"rgba(0,0,0,0.1)"}`,l.setAttribute("data-event-id",e.id);const v=document.createElement("span");v.className="font-bold whitespace-nowrap opacity-90 text-[10px]",v.textContent=d(e.start).format("HH:mm");const f=document.createElement("span");f.className="flex-1 overflow-hidden text-ellipsis whitespace-nowrap font-medium",f.textContent=((b=e.extendedProps)==null?void 0:b.schedule_type_name)||e.title,l.appendChild(v),l.appendChild(f),l.addEventListener("click",B=>{B.stopPropagation();const L={id:e.id,title:e.title,start:e.start,end:e.end,backgroundColor:e.backgroundColor,borderColor:e.borderColor,extendedProps:e.extendedProps};P({event:L})}),w.appendChild(l)}),k.appendChild(w);const C=document.createElement("div");C.className="h-[40%] min-h-[40px] bg-blue-50/50 dark:bg-blue-900/10 p-1 overflow-hidden flex flex-col border-2 border-blue-400 cursor-pointer hover:bg-blue-100 dark:hover:bg-blue-900/20 transition-colors",C.addEventListener("click",e=>{e.stopPropagation(),h.value=a,g.value=null,E.value="入浴スケジュール作成",m.value=!0});const _=document.createElement("div");if(_.className="flex flex-col gap-1 overflow-y-auto flex-1",o&&o.bathSchedules.length>0)o.bathSchedules.forEach(e=>{var b;const l=document.createElement("div");l.className="flex items-center gap-1.5 px-2 py-1 rounded-md text-xs text-white cursor-pointer hover:opacity-90 transition-all shadow-sm transform hover:scale-[1.02]",l.style.backgroundColor=e.backgroundColor||"#3B82F6",l.style.borderLeft=`3px solid ${e.borderColor||"rgba(0,0,0,0.1)"}`,l.setAttribute("data-event-id",e.id);const v=document.createElement("span");v.className="font-bold whitespace-nowrap opacity-90 text-[10px]",v.textContent=d(e.start).format("HH:mm");const f=document.createElement("span");f.className="flex-1 overflow-hidden text-ellipsis whitespace-nowrap font-medium",f.textContent=((b=e.extendedProps)==null?void 0:b.schedule_type_name)||e.title,l.appendChild(v),l.appendChild(f),l.addEventListener("click",B=>{B.stopPropagation();const L={id:e.id,title:e.title,start:e.start,end:e.end,backgroundColor:e.backgroundColor,borderColor:e.borderColor,extendedProps:e.extendedProps};P({event:L})}),_.appendChild(l)});else{const e=document.createElement("span");e.className="text-[10px] text-gray-400 italic pl-1",e.innerText="-",_.appendChild(e)}return C.appendChild(_),k.appendChild(C),p.appendChild(k),{domNodes:[p]}},J=t=>{const a=t.el.querySelector(".fc-daygrid-day-frame");if(a){const o=a.querySelector(".fc-daygrid-day-events");o&&(o.style.display="none");const n=a.querySelector(".fc-daygrid-day-bg");n&&(n.style.display="none")}},Q=V(()=>({plugins:[fe,xe],initialView:"dayGridMonth",locale:ve,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,customWeek,customDay"},customButtons:{customWeek:{text:"週",click:()=>{D.get(route("calendar.week"),{date:M.value})}},customDay:{text:"日",click:()=>{D.get(route("calendar.day"),{date:M.value})}}},buttonText:{today:"今日",month:"月",week:"週",day:"日"},eventDisplay:"none",height:"auto",editable:!1,selectable:!1,dateClick:U,eventClick:P,dayCellContent:K,dayCellDidMount:J,dayMaxEvents:!1,dayHeaderFormat:{weekday:"short"}})),X=t=>{t&&(t.start&&d(t.start).format("YYYY-MM-DD"),c.value=[...c.value,t],u.value&&u.value.getApi().addEvent(t),z(()=>{u.value&&u.value.getApi().render()}),i.value&&(i.value={...i.value,total:i.value.total+1}))},Z=()=>{m.value=!1,h.value=null,g.value=null},ee=()=>{D.reload({only:["events","monthStats"]})},te=t=>{if(H(),m.value=!1,t){const a=c.value.find(o=>o.id===t);if(a&&d(a.start).format("YYYY-MM-DD"),c.value=c.value.filter(o=>o.id!==t),u.value){const n=u.value.getApi().getEventById(t);n&&n.remove()}z(()=>{u.value&&u.value.getApi().render()}),i.value&&(i.value={...i.value,total:Math.max(0,i.value.total-1)})}},H=()=>{N.value=!1,A.value=null};return(t,a)=>(Y(),R(ce,null,{default:le(()=>[F(q(ne),{title:"カレンダー"}),r("div",ge,[r("div",ye,[a[3]||(a[3]=r("div",{class:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4"},[r("div",null,[r("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100 tracking-tight"},"カレンダー"),r("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"スケジュールの確認と管理ができます")])],-1)),r("div",be,[r("div",ke,[r("div",we,[(Y(),R(q(ue),{key:$.value,ref_key:"calendarRef",ref:u,options:Q.value,onDatesSet:G},null,8,["options"]))])])]),r("div",Ce,[a[2]||(a[2]=r("h2",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4 px-1"},"今月の統計",-1)),r("div",_e,[r("div",Ye,[a[0]||(a[0]=r("div",{class:"flex items-center justify-between mb-2"},[r("div",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"総スケジュール"),r("div",{class:"p-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400"},[r("i",{class:"bi bi-calendar-check text-lg"})])],-1)),r("div",De,j(i.value.total),1)]),(Y(!0),O(se,null,de(S.value,o=>(Y(),O("div",{key:o.id,class:"bg-white dark:bg-gray-800 p-5 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 transition-transform hover:-translate-y-1 duration-300"},[r("div",Se,[r("div",Me,j(o.name),1),r("div",{class:"p-2 rounded-lg",style:ie({backgroundColor:o.color?`${o.color}20`:"#e5e7eb",color:o.color||"#6b7280"})},[...a[1]||(a[1]=[r("i",{class:"bi bi-circle-fill text-xs"},null,-1)])],4)]),r("div",Ee,j(i.value.by_type[o.id]||0),1)]))),128))])])])]),F(me,{show:m.value,"initial-date":h.value,"initial-resident-id":g.value,residents:I.value,"schedule-types":S.value,title:E.value,onClose:Z,onSuccess:X},null,8,["show","initial-date","initial-resident-id","residents","schedule-types","title"]),F(pe,{show:N.value,schedule:A.value,residents:I.value,"schedule-types":S.value,onClose:H,onUpdated:ee,onDeleted:te},null,8,["show","schedule","residents","schedule-types"])]),_:1}))}},He=he(Ne,[["__scopeId","data-v-2237f3f9"]]);export{He as default};
